<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logic Flow | NTSGROW</title>
    <style>
        :root {
            --primary: #3498db;
            --dark: #1a1a1a;
            --light: #f4f4f4;
            --target: #e74c3c;
        }

        body {
            background-color: var(--dark);
            color: var(--light);
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        /* Home Button */
        .home-nav {
            position: absolute;
            top: 20px;
            left: 20px;
        }

        .btn-home {
            text-decoration: none;
            color: var(--light);
            border: 1px solid var(--light);
            padding: 8px 15px;
            border-radius: 5px;
            font-size: 0.9rem;
            transition: 0.3s;
        }

        .btn-home:hover {
            background: var(--light);
            color: var(--dark);
        }

        h1 { color: var(--primary); margin-bottom: 5px; letter-spacing: 2px; }
        .stats { margin-bottom: 15px; font-size: 1.1rem; }

        /* Puzzle Board */
        .puzzle-board {
            display: grid;
            grid-template-columns: repeat(4, 70px);
            grid-template-rows: repeat(4, 70px);
            gap: 5px;
            background: #333;
            padding: 10px;
            border-radius: 8px;
            border: 4px solid #444;
        }

        .tile {
            width: 70px;
            height: 70px;
            background: #444;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            border-radius: 4px;
            cursor: pointer;
            user-select: none;
            transition: 0.2s;
        }

        .tile:hover { background: #555; }
        
        .tile.empty { background: var(--dark); cursor: default; }
        
        .tile.number {
            background: var(--primary);
            color: white;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.2);
        }

        .controls { margin-top: 25px; text-align: center; }
        
        .btn-reset {
            padding: 10px 25px;
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .btn-reset:hover { background: var(--primary); color: white; }

        @media (max-width: 400px) {
            .puzzle-board { grid-template-columns: repeat(4, 60px); grid-template-rows: repeat(4, 60px); }
            .tile { width: 60px; height: 60px; }
        }
    </style>
</head>
<body onclick="startMusic()">

    <nav class="home-nav">
        <a href="index.html" class="btn-home">‚Üê Back to NTSGROW</a>
    </nav>

    <audio id="bgMusic" loop>
        <source src="game2music.mp3" type="audio/mpeg">
    </audio>

    <h1>Logic Flow</h1>
    <div class="stats">Moves: <span id="moves">0</span></div>

    <div class="puzzle-board" id="board"></div>

    <div class="controls">
        <button class="btn-reset" onclick="initGame()">Shuffle & Restart</button>
        <p style="margin-top: 15px; color: #888; font-size: 0.9rem;">Arrange numbers in order (1 to 15)</p>
    </div>

    <script>
        const boardElement = document.getElementById('board');
        const movesElement = document.getElementById('moves');
        const bgMusic = document.getElementById('bgMusic');
        let tiles = [];
        let moves = 0;
        let musicStarted = false;

        function startMusic() {
            if(!musicStarted) {
                bgMusic.play().catch(() => {});
                musicStarted = true;
            }
        }

        function initGame() {
            moves = 0;
            movesElement.innerText = moves;
            // Create array 1 to 15 and one empty slot (0)
            tiles = [...Array(15).keys()].map(x => x + 1);
            tiles.push(0); 
            
            shuffle(tiles);
            renderBoard();
        }

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            // Check if solvable, if not shuffle again (Simplified for this version)
        }

        function renderBoard() {
            boardElement.innerHTML = '';
            tiles.forEach((tile, index) => {
                const tileDiv = document.createElement('div');
                tileDiv.classList.add('tile');
                if (tile === 0) {
                    tileDiv.classList.add('empty');
                    tileDiv.innerText = '';
                } else {
                    tileDiv.classList.add('number');
                    tileDiv.innerText = tile;
                    tileDiv.onclick = () => moveTile(index);
                }
                boardElement.appendChild(tileDiv);
            });
        }

        function moveTile(index) {
            const emptyIndex = tiles.indexOf(0);
            const isAdjacent = checkAdjacent(index, emptyIndex);

            if (isAdjacent) {
                // Swap
                [tiles[index], tiles[emptyIndex]] = [tiles[emptyIndex], tiles[index]];
                moves++;
                movesElement.innerText = moves;
                renderBoard();
                checkWin();
            }
        }

        function checkAdjacent(idx1, idx2) {
            const row1 = Math.floor(idx1 / 4);
            const col1 = idx1 % 4;
            const row2 = Math.floor(idx2 / 4);
            const col2 = idx2 % 4;

            const rowDiff = Math.abs(row1 - row2);
            const colDiff = Math.abs(col1 - col2);

            return (rowDiff === 1 && colDiff === 0) || (rowDiff === 0 && colDiff === 1);
        }

        function checkWin() {
            const winState = [...Array(15).keys()].map(x => x + 1);
            winState.push(0);
            if (tiles.every((val, index) => val === winState[index])) {
                setTimeout(() => {
                    alert("Brilliant! You solved it in " + moves + " moves.");
                    initGame();
                }, 300);
            }
        }

        initGame();
    </script>
</body>
</html>