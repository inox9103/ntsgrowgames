<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orbital Reflex | NTSGROW</title>
    <style>
        :root {
            --primary: #9b59b6;
            --dark: #1a1a1a;
            --light: #f4f4f4;
            --accent: #f1c40f;
        }

        body {
            background-color: var(--dark);
            color: var(--light);
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            touch-action: manipulation;
        }

        /* Home Button */
        .home-nav {
            position: absolute;
            top: 20px;
            left: 20px;
        }

        .btn-home {
            text-decoration: none;
            color: var(--light);
            border: 1px solid var(--light);
            padding: 8px 15px;
            border-radius: 5px;
            font-size: 0.9rem;
            transition: 0.3s;
        }

        .btn-home:hover { background: var(--light); color: var(--dark); }

        h1 { color: var(--primary); margin-bottom: 5px; letter-spacing: 2px; }
        .score { font-size: 1.5rem; margin-bottom: 20px; }

        /* Game Canvas Area */
        #gameCanvas {
            background: #252525;
            border-radius: 50%;
            border: 5px solid #333;
            box-shadow: 0 0 50px rgba(155, 89, 182, 0.2);
            cursor: pointer;
        }

        .instructions {
            margin-top: 25px;
            color: #888;
            text-align: center;
            max-width: 300px;
        }

        .start-btn {
            margin-top: 20px;
            padding: 12px 35px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
        }
    </style>
</head>
<body onclick="startMusic()">

    <nav class="home-nav">
        <a href="index.html" class="btn-home">‚Üê Back to NTSGROW</a>
    </nav>

    <audio id="bgMusic" loop>
        <source src="game5music.mp3" type="audio/mpeg">
    </audio>

    <h1>Orbital Reflex</h1>
    <div class="score">Score: <span id="scoreVal">0</span></div>

    <canvas id="gameCanvas" width="300" height="300"></canvas>

    <div id="ui">
        <button class="start-btn" id="startBtn" onclick="startGame()">Start Game</button>
    </div>
    
    <p class="instructions">Click anywhere when the moving dot overlaps the target zone!</p>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreDisplay = document.getElementById('scoreVal');
        const bgMusic = document.getElementById('bgMusic');
        
        let score = 0;
        let angle = 0;
        let targetAngle = Math.random() * Math.PI * 2;
        let speed = 0.05;
        let gameActive = false;
        let musicStarted = false;

        function startMusic() {
            if(!musicStarted) {
                bgMusic.play().catch(() => {});
                musicStarted = true;
            }
        }

        function startGame() {
            score = 0;
            speed = 0.05;
            scoreDisplay.innerText = score;
            gameActive = true;
            document.getElementById('startBtn').style.visibility = 'hidden';
            animate();
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw Central Hub
            ctx.beginPath();
            ctx.arc(150, 150, 10, 0, Math.PI * 2);
            ctx.fillStyle = "#444";
            ctx.fill();

            // Draw Target Zone
            ctx.beginPath();
            ctx.arc(150, 150, 120, targetAngle - 0.3, targetAngle + 0.3);
            ctx.strokeStyle = "#f1c40f";
            ctx.lineWidth = 15;
            ctx.stroke();

            // Draw Moving Orbiter
            let orbX = 150 + Math.cos(angle) * 120;
            let orbY = 150 + Math.sin(angle) * 120;

            ctx.beginPath();
            ctx.arc(orbX, orbY, 12, 0, Math.PI * 2);
            ctx.fillStyle = "#9b59b6";
            ctx.fill();
            ctx.shadowBlur = 15;
            ctx.shadowColor = "#9b59b6";
        }

        function update() {
            if(!gameActive) return;
            angle += speed;
            if (angle > Math.PI * 2) angle = 0;
        }

        function animate() {
            if(!gameActive) return;
            draw();
            update();
            requestAnimationFrame(animate);
        }

        // Handle Click/Tap
        window.addEventListener('mousedown', function() {
            if(!gameActive) return;

            // Check if angle matches targetAngle (with some tolerance)
            let diff = Math.abs(angle - targetAngle);
            // Handling the 0/2PI wrap around
            if (diff > Math.PI) diff = Math.abs(diff - Math.PI * 2);

            if (diff < 0.35) {
                score++;
                scoreDisplay.innerText = score;
                targetAngle = Math.random() * Math.PI * 2;
                speed += 0.003; // Increase difficulty
            } else {
                gameActive = false;
                alert("Missed! Final Score: " + score);
                document.getElementById('startBtn').style.visibility = 'visible';
                location.reload();
            }
        });

        draw(); // Initial draw
    </script>
</body>
</html>